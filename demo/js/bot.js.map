{"version":3,"sources":["../../src/demo/js/bot.js"],"names":["window","metamind","Metamind","apiUrl","botImage","Math","random","toString","substr","$","document","on","e","sendMessage","text","click","disabled","attr","val","undefined","message","empty","append","scrollTop","scrollHeight","replaceLineBreaks","replace","data","removeAttr","i","quickResponses","length","hint","response"],"mappings":"AAAA,CAAC,IAAM,CACL,aAEAA,OAAOC,QAAP,CAAkB,GAAID,QAAOE,QAAX,CAAoB,CAACC,OAAQ,6CAAT,CAApB,CAAlB,CAEA,GAAIC,UAAW,wBAA0BC,KAAKC,MAAL,GAAcC,QAAd,CAAuB,EAAvB,EAA2BC,MAA3B,CAAkC,CAAlC,CAAzC,CAEAC,EAAEC,QAAF,EAAYC,EAAZ,CAAe,OAAf,CAAwB,oBAAxB,CAA8C,SAASC,CAAT,CAAY,CACxDC,YAAYJ,EAAE,IAAF,EAAQK,IAAR,EAAZ,CACD,CAFD,EAIAL,EAAE,mBAAF,EAAuBM,KAAvB,CAA6B,SAASH,CAAT,CAAY,CACvC,GAAII,UAAWP,EAAE,IAAF,EAAQQ,IAAR,CAAa,UAAb,CAAf,CACA,GAAIH,MAAOL,EAAE,kBAAF,EAAsBS,GAAtB,EAAX,CAEA,GAAI,MAAOF,SAAP,GAAoB,MAAOG,UAA3B,EAAwCH,WAAa,KAAzD,CAAgE,CAC9D,MACD,CAEDH,YAAYC,IAAZ,CACD,CATD,EAWA,QAASD,YAAT,CAAqBO,OAArB,CAA8B,CAC5BX,EAAE,mBAAF,EAAuBQ,IAAvB,CAA4B,UAA5B,CAAwC,UAAxC,EACAR,EAAE,cAAF,EAAkBK,IAAlB,CAAuB,EAAvB,EACAL,EAAE,kBAAF,EAAsBY,KAAtB,GACAZ,EAAE,uBAAF,EAA2Ba,MAA3B,CACG;;;;;;eAMQF,OAAQ;;;;aAPnB,EAaAX,EAAE,uBAAF,EAA2B,CAA3B,EAA8Bc,SAA9B,CAA0Cd,EAAE,uBAAF,EAA2B,CAA3B,EAA8Be,YAAxE,CACAxB,OAAOC,QAAP,CAAgBY,WAAhB,CAA4BO,OAA5B,CACD,CAED,QAASK,kBAAT,CAA2BX,IAA3B,CAAiC,CAC/B,MAAO,CAACA,MAAM,EAAP,EAAWY,OAAX,CAAmB,KAAnB,CAA0B,OAA1B,CACR,CAED1B,OAAOC,QAAP,CAAgBU,EAAhB,CAAmB,UAAnB,CAA+B,SAASgB,IAAT,CAAe,CAC5ClB,EAAE,mBAAF,EAAuBmB,UAAvB,CAAkC,UAAlC,EACAnB,EAAE,kBAAF,EAAsBS,GAAtB,CAA0B,EAA1B,EAEA,IAAK,GAAIW,GAAI,CAAb,CAAgBA,EAAIF,KAAKG,cAAL,CAAoBC,MAAxC,CAAgDF,GAAhD,CAAqD,CACnDpB,EAAE,kBAAF,EAAsBa,MAAtB,CAA8B,yDAAwDK,KAAKG,cAAL,CAAoBD,CAApB,CAAuB,WAA7G,CACD,CAEDpB,EAAE,cAAF,EAAkBK,IAAlB,CAAuBa,KAAKK,IAAL,EAAa,EAApC,EAEAvB,EAAE,uBAAF,EAA2Ba,MAA3B,CACG;;;+CAGwClB,QAAS;;;eAGzCqB,kBAAkBE,KAAKM,QAAvB,CAAiC;;;;aAP5C,EAaAxB,EAAE,uBAAF,EAA2B,CAA3B,EAA8Bc,SAA9B,CAA0Cd,EAAE,uBAAF,EAA2B,CAA3B,EAA8Be,YACzE,CAxBD,CAyBD,CAxED","file":"bot.js","sourcesContent":["(() => {\n  'use strict';\n\n  window.metamind = new window.Metamind({apiUrl: 'http://dev-metamind-api.metatavu.io:8080/v1'});\n\n  var botImage = 'https://robohash.org/' + Math.random().toString(36).substr(2);\n\n  $(document).on('click', '.quick-message-btn', function(e) {\n    sendMessage($(this).text());\n  });\n\n  $('.send-message-btn').click(function(e) {\n    var disabled = $(this).attr('disabled');\n    var text = $('.user-text-input').val();\n\n    if (typeof disabled !== typeof undefined && disabled !== false) {\n      return;\n    }\n\n    sendMessage(text);\n  });\n  \n  function sendMessage(message) {\n    $('.send-message-btn').attr('disabled', 'disabled');\n    $('#botHintText').text('');\n    $('.quick-responses').empty();\n    $('.discussion-container').append(\n      `<div class=\"card user-response\">\n        <div class=\"card-body\">\n          <div class=\"media\">\n           <img class=\"mr-3 user-image\" src=\"gfx/user.png\">\n           <div class=\"media-body\">\n             <h5 class=\"mt-0\">Käyttäjä</h5>\n             ${message}\n           </div>\n          </div>\n        </div>\n      </div>`  \n    );\n    $('.discussion-container')[0].scrollTop = $('.discussion-container')[0].scrollHeight;\n    window.metamind.sendMessage(message);\n  }\n  \n  function replaceLineBreaks(text) {\n    return (text||'').replace(/\\n/g, '<br/>');\n  }\n\n  window.metamind.on('response', function(data) {\n    $('.send-message-btn').removeAttr('disabled');\n    $('.user-text-input').val('');\n\n    for (var i = 0; i < data.quickResponses.length; i++) {\n      $('.quick-responses').append(`<button class=\"btn btn-info btn-sm quick-message-btn\">${data.quickResponses[i]}</button>`);\n    }\n\n    $('#botHintText').text(data.hint || '');\n\n    $('.discussion-container').append(\n      `<div class=\"card bot-response\">\n        <div class=\"card-body\">\n          <div class=\"media\">\n           <img class=\"mr-3 user-image\" src=\"${botImage}\">\n           <div class=\"media-body\">\n             <h5 class=\"mt-0\">Metamind</h5>\n             ${replaceLineBreaks(data.response)}\n           </div>\n          </div>\n        </div>\n      </div>`  \n    );\n    $('.discussion-container')[0].scrollTop = $('.discussion-container')[0].scrollHeight;\n  });\n})();"]}