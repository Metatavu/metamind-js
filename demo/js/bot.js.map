{"version":3,"sources":["../../src/demo/js/bot.js"],"names":["window","metamind","Metamind","apiUrl","botImage","Math","random","toString","substr","$","document","on","e","sendMessage","text","click","show","disabled","attr","message","val","undefined","empty","append","scrollTop","scrollHeight","replaceLineBreaks","replace","data","hide","removeAttr","i","quickResponses","length","hint","response","ready","event","keyCode"],"mappings":"AAAA,CAAC,IAAM,CACL,aAEAA,OAAOC,QAAP,CAAkB,GAAID,QAAOE,QAAX,CAAoB,CAACC,OAAQ,6CAAT,CAAwD,QAAS,yBAAjE,CAApB,CAAlB,CAEA,GAAIC,UAAW,wBAA0BC,KAAKC,MAAL,GAAcC,QAAd,CAAuB,EAAvB,EAA2BC,MAA3B,CAAkC,CAAlC,CAAzC,CAEAC,EAAEC,QAAF,EAAYC,EAAZ,CAAe,OAAf,CAAwB,oBAAxB,CAA8C,SAASC,CAAT,CAAY,CACxDC,YAAYJ,EAAE,IAAF,EAAQK,IAAR,EAAZ,CACD,CAFD,EAIAL,EAAE,mBAAF,EAAuBM,KAAvB,CAA6B,SAASH,CAAT,CAAY,CACvCC,aACD,CAFD,EAIA,QAASA,YAAT,CAAqBC,IAArB,CAA2B,CACzBL,EAAE,aAAF,EAAiBO,IAAjB,GACA,KAAMC,UAAWR,EAAE,mBAAF,EAAuBS,IAAvB,CAA4B,UAA5B,CAAjB,CACA,KAAMC,SAAUL,MAAQL,EAAE,kBAAF,EAAsBW,GAAtB,EAAxB,CAEA,GAAI,MAAOH,SAAP,GAAoB,MAAOI,UAA3B,EAAwCJ,WAAa,KAAzD,CAAgE,CAC9D,MACD,CAEDR,EAAE,mBAAF,EAAuBS,IAAvB,CAA4B,UAA5B,CAAwC,UAAxC,EACAT,EAAE,cAAF,EAAkBK,IAAlB,CAAuB,EAAvB,EACAL,EAAE,kBAAF,EAAsBa,KAAtB,GACAb,EAAE,uBAAF,EAA2Bc,MAA3B,CACG;;;;;;eAMQJ,OAAQ;;;;aAPnB,EAaAV,EAAE,uBAAF,EAA2B,CAA3B,EAA8Be,SAA9B,CAA0Cf,EAAE,uBAAF,EAA2B,CAA3B,EAA8BgB,YAAxE,CACAzB,OAAOC,QAAP,CAAgBY,WAAhB,CAA4BM,OAA5B,CACD,CAED,QAASO,kBAAT,CAA2BZ,IAA3B,CAAiC,CAC/B,MAAO,CAACA,MAAM,EAAP,EAAWa,OAAX,CAAmB,KAAnB,CAA0B,OAA1B,CACR,CAED3B,OAAOC,QAAP,CAAgBU,EAAhB,CAAmB,UAAnB,CAA+B,SAASiB,IAAT,CAAe,CAC5CnB,EAAE,aAAF,EAAiBoB,IAAjB,GACApB,EAAE,mBAAF,EAAuBqB,UAAvB,CAAkC,UAAlC,EACArB,EAAE,kBAAF,EAAsBW,GAAtB,CAA0B,EAA1B,EAEA,IAAK,GAAIW,GAAI,CAAb,CAAgBA,EAAIH,KAAKI,cAAL,CAAoBC,MAAxC,CAAgDF,GAAhD,CAAqD,CACnDtB,EAAE,kBAAF,EAAsBc,MAAtB,CAA8B,yDAAwDK,KAAKI,cAAL,CAAoBD,CAApB,CAAuB,WAA7G,CACD,CAEDtB,EAAE,cAAF,EAAkBK,IAAlB,CAAuBc,KAAKM,IAAL,EAAa,EAApC,EAEAzB,EAAE,uBAAF,EAA2Bc,MAA3B,CACG;;;+CAGwCnB,QAAS;;;eAGzCsB,kBAAkBE,KAAKO,QAAvB,CAAiC;;;;aAP5C,EAaA1B,EAAE,uBAAF,EAA2B,CAA3B,EAA8Be,SAA9B,CAA0Cf,EAAE,uBAAF,EAA2B,CAA3B,EAA8BgB,YACzE,CAzBD,EA2BAhB,EAAEC,QAAF,EAAY0B,KAAZ,CAAkB,IAAM,CACtB3B,EAAE,aAAF,EAAiBoB,IAAjB,GACApB,EAAE,mBAAF,EAAuBS,IAAvB,CAA4B,UAA5B,CAAwC,UAAxC,EACAlB,OAAOC,QAAP,CAAgBY,WAAhB,CAA4B,MAA5B,CACD,CAJD,EAMAJ,EAAEC,QAAF,EAAYC,EAAZ,CAAe,SAAf,CAA2B0B,KAAD,EAAW,CACnC,GAAIA,MAAMC,OAAN,GAAkB,EAAtB,CAA0B,CACxBzB,aACD,CACF,CAJD,CAMD,CAvFD","file":"bot.js","sourcesContent":["(() => {\n  'use strict';\n\n  window.metamind = new window.Metamind({apiUrl: 'http://dev-metamind-api.metatavu.io:8080/v1', 'story': 'lumme-electricity-order' });\n\n  var botImage = 'https://robohash.org/' + Math.random().toString(36).substr(2);\n  \n  $(document).on('click', '.quick-message-btn', function(e) {\n    sendMessage($(this).text());\n  });\n\n  $('.send-message-btn').click(function(e) {\n    sendMessage();\n  });\n  \n  function sendMessage(text) {\n    $('.bot-typing').show();\n    const disabled = $('.send-message-btn').attr('disabled');\n    const message = text || $('.user-text-input').val();\n\n    if (typeof disabled !== typeof undefined && disabled !== false) {\n      return;\n    }\n\n    $('.send-message-btn').attr('disabled', 'disabled');\n    $('#botHintText').text('');\n    $('.quick-responses').empty();\n    $('.discussion-container').append(\n      `<div class=\"card user-response\">\n        <div class=\"card-body\">\n          <div class=\"media\">\n           <img class=\"mr-3 user-image\" src=\"gfx/user.png\">\n           <div class=\"media-body\">\n             <h5 class=\"mt-0\">Käyttäjä</h5>\n             ${message}\n           </div>\n          </div>\n        </div>\n      </div>`  \n    );\n    $('.discussion-container')[0].scrollTop = $('.discussion-container')[0].scrollHeight;\n    window.metamind.sendMessage(message);\n  }\n  \n  function replaceLineBreaks(text) {\n    return (text||'').replace(/\\n/g, '<br/>');\n  }\n\n  window.metamind.on('response', function(data) {\n    $('.bot-typing').hide();\n    $('.send-message-btn').removeAttr('disabled');\n    $('.user-text-input').val('');\n\n    for (var i = 0; i < data.quickResponses.length; i++) {\n      $('.quick-responses').append(`<button class=\"btn btn-info btn-sm quick-message-btn\">${data.quickResponses[i]}</button>`);\n    }\n\n    $('#botHintText').text(data.hint || '');\n\n    $('.discussion-container').append(\n      `<div class=\"card bot-response\">\n        <div class=\"card-body\">\n          <div class=\"media\">\n           <img class=\"mr-3 user-image\" src=\"${botImage}\">\n           <div class=\"media-body\">\n             <h5 class=\"mt-0\">Lumme Bot</h5>\n             ${replaceLineBreaks(data.response)}\n           </div>\n          </div>\n        </div>\n      </div>`  \n    );\n    $('.discussion-container')[0].scrollTop = $('.discussion-container')[0].scrollHeight;\n  });\n  \n  $(document).ready(() => {\n    $('.bot-typing').hide();\n    $('.send-message-btn').attr('disabled', 'disabled');\n    window.metamind.sendMessage('INIT');\n  });\n  \n  $(document).on('keydown', (event) => {\n    if (event.keyCode === 13) {\n      sendMessage();\n    }\n  });\n  \n})();"]}